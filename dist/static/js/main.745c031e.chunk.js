(this["webpackJsonpnginx-gui"]=this["webpackJsonpnginx-gui"]||[]).push([[0],{137:function(e,t,n){e.exports={form:"style_form__3dz31",buttonItem:"style_buttonItem__3_Pl0"}},140:function(e,t,n){e.exports={spin:"style_spin__250sK",card:"style_card__3C50E"}},187:function(e,t){e.exports=require("os")},188:function(e,t){e.exports=require("child_process")},19:function(e,t){e.exports=require("path")},194:function(e,t,n){e.exports={log:"style_log__x9jBQ"}},198:function(e,t,n){e.exports=n(426)},26:function(e,t){e.exports=require("electron")},425:function(e,t,n){},426:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(4),o=n.n(c),i=(n(203),n(6)),s=n.n(i),u=n(15),l=n(197),f=(n(104),n(71)),m=n.n(f),p=(n(106),n(56)),d=n.n(p),g=(n(41),n(14)),x=n.n(g),h=n(13),v=n(85),b=(n(207),n(192)),E=n.n(b),j=n(38),k=n(28),w=(n(141),n(40)),O=n.n(w),y=n(433),C=(n(210),n(190)),S=n.n(C),N=n(432),$=n(26),I=(n(142),n(59)),_=n.n(I),F=n(187),P=n.n(F),R=n(58),q=n.n(R),T=n(188),B=n.n(T),z=P.a.type(),L="Windows_NT"===z,V=function(e){return e?e.trim().replace(/\\/g,"/"):""},J=function(){if(arguments.length)return 1===arguments.length?localStorage.getItem(arguments.length<=0?void 0:arguments[0]):localStorage.setItem(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1])},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300;return new Promise((function(t){setTimeout((function(){return t()}),e)}))},U=function(e){var t=null;return function(){clearTimeout(t),t=setTimeout((function(){e&&e()}),100)}},A=function(e,t){return new Promise((function(n,a){q.a.access(e,(function(e){e?(a(t||"\u6587\u4ef6\u4e0d\u5b58\u5728"),t&&_.a.error(t)):n()}))}))},K=function(e){return new Promise((function(t,n){q.a.readFile(e,(function(e,a){e?n():t(a.toString())}))}))},M=function(e,t){return new Promise((function(n,a){B.a.exec(e,(function(e){e?(a(t),t&&_.a.error(t)):n()}))}))},W=function(e){var t="lsof -nP -i | grep";return L&&(t="tasklist|findstr"),M("".concat(t," ").concat(e))},D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new Promise((function(n,a){q.a.writeFile(e,t,(function(e){e?a():n()}))}))},Q=Object(a.createContext)(),H=/\.\w+$/,X=function(e){var t=e.name,n=e.label,c=e.ext,o=(e.input,e.onSelect),i=e.onChange,s=e.onFocus,u=e.onBlur,l=e.onRemove,f=e.required,p=void 0===f||f,g=Object(j.a)(e,["name","label","ext","input","onSelect","onChange","onFocus","onBlur","onRemove","required"]),h=Object(a.useContext)(Q),v=function e(){(arguments.length<=1?void 0:arguments[1])&&o(t,arguments.length<=1?void 0:arguments[1]),$.ipcRenderer.removeListener("selectedItem",e)},b=U((function(){var e=c.match(H);$.ipcRenderer.send("open-directory-dialog",{defaultPath:h.getFieldValue(t),properties:["openFile"],filters:[{name:"All Files",extensions:[e?e[0].substr(1):"*"]}]}),$.ipcRenderer.on("selectedItem",v)})),E=function(e,t){if(t){var n=t.trim(),a=c.match(H),r=t.match(H);return a?n.endsWith(a[0])?["nginx","conf"].includes()?A(n):Promise.resolve():Promise.reject("\u6587\u4ef6\u683c\u5f0f\u9519\u8bef\uff0c\u5fc5\u987b\u4ee5".concat(a[0],"\u7ed3\u5c3e")):r?Promise.reject("\u6587\u4ef6\u683c\u5f0f\u9519\u8bef\uff0c\u4e0d\u5141\u8bb8\u4ee5".concat(r[0],"\u7ed3\u5c3e")):A(n)}return Promise.resolve()},k=[function(){return{validator:E}}];return p&&k.unshift({required:!0,message:"".concat(n,"\u8def\u5f84\u4e0d\u80fd\u4e3a\u7a7a")}),r.a.createElement(O.a.Item,Object.assign({},g,{label:n}),r.a.createElement(m.a,{gutter:8},r.a.createElement(d.a,{span:19},r.a.createElement(O.a.Item,{name:t,noStyle:!0,rules:k,validateTrigger:"onBlur"},r.a.createElement(S.a,{placeholder:"\u8bf7\u8f93\u5165\u6216\u9009\u62e9".concat(n,"\u8def\u5f84"),onChange:i,onFocus:function(e){s&&s(e),e.target.select()},onBlur:u,autoComplete:"off"}))),r.a.createElement(d.a,{span:5},r.a.createElement(x.a,{onClick:b},"\u9009 \u62e9"),l?r.a.createElement(N.a,{onClick:l,className:"e-ml8"}):"")))},Y=n(19),Z=n.n(Y),ee="./nginx.conf",te="./nginx.pid",ne="./access.log",ae="./error.log",re=L?"":"/usr/local/bin/nginx",ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t={};return e&&(t.nginx=e,L?(t.conf=Z.a.join(e,"../conf",ee),t.pid=Z.a.join(e,"../logs",te),t.access=Z.a.join(e,"../logs",ne),t.error=Z.a.join(e,"../logs",ae)):(t.conf=Z.a.join(e,"../../etc/nginx",ee),t.pid=Z.a.join(e,"../../var/run",te),t.access=Z.a.join(e,"../../var/log/nginx",ne),t.error=Z.a.join(e,"../../var/log/nginx",ae))),t},oe=n(137),ie=n.n(oe),se=O.a.Item,ue=O.a.List,le="nginx".concat(L?".exe":""),fe={labelCol:{sm:{span:4}},wrapperCol:{sm:{span:20}},className:ie.a.form},me={labelCol:{sm:{span:0}},wrapperCol:{sm:{span:24}}},pe=[{name:"access",label:"Access Log"},{name:"error",label:"Error Log"}],de=function(){var e=Object(u.useConnect)(),t=Object(k.a)(e,2),n=t[0],c=n.loadings,o=Object(j.a)(n,["loadings"]),i=t[1],s=Object(u.useNuomi)().nuomiProps,l=O.a.useForm(),f=Object(k.a)(l,1)[0],p=Object(a.useRef)(),g=null,b=function(e){if(g){var t={},n=ce(e);g.forEach((function(e){t[e]=n[e]})),f.setFieldsValue(t)}},w=function(){var e=f.getFieldsValue();Object.keys(e).forEach((function(t){["nginx","logs"].includes(t)||e[t]||(g||(g=[]),g.push(t))}))},C=function(){g=null},S=function(e,t){f.setFieldsValue(Object(h.a)({},e,t)),"nginx"===e&&(w(),b(t),C())};return r.a.createElement(Q.Provider,{value:f},r.a.createElement(O.a,Object.assign({form:f,onFinish:function(e){i({type:"$saveNginx",payload:e})}},fe,{initialValues:o}),r.a.createElement("div",{ref:p},r.a.createElement(X,{extra:"\u9009\u62e9".concat(le,"\u540e\uff0c\u5176\u4ed6\u9879\u8def\u5f84\u4f1a\u88ab\u81ea\u52a8\u586b\u5145\uff0c\u5982\u679c\u9519\u8bef\u8bf7\u81ea\u884c\u4fee\u6539"),name:"nginx",label:"Nginx",ext:L?".exe":"",onSelect:S,onChange:function(e){var t=e.target.value;b(t)},onFocus:w,onBlur:C}),r.a.createElement(X,{name:"conf",label:"Conf",ext:".conf",onSelect:S}),r.a.createElement(X,{name:"pid",label:"Pid",ext:".pid",onSelect:S}),pe.map((function(e){var t=e.name,n=e.label;return r.a.createElement(X,{key:t,name:t,label:n,ext:".log",onSelect:S,required:!1})})),r.a.createElement(ue,{name:"logs"},(function(e,t){var n=t.add,a=t.remove;return r.a.createElement(r.a.Fragment,null,e.map((function(e,t){return r.a.createElement(X,Object.assign({},e,{label:0===t?"Other Log":"",wrapperCol:0===t?null:{sm:{offset:4,span:20}},ext:".log",onRemove:function(){return a(e.name)},onSelect:S,required:!1}))})),r.a.createElement(se,{label:" ",colon:!1,required:!1,className:"e-mb8"},r.a.createElement(m.a,{gutter:8},r.a.createElement(d.a,{span:19},r.a.createElement(x.a,{type:"dashed",onClick:function(){return function(e){e(),setTimeout((function(){p.current.scrollTop=19920604}),0)}(n)},style:{width:"100%"}},r.a.createElement(y.a,null)," \u65b0\u589e\u65e5\u5fd7\u9879")))))})),r.a.createElement(se,Object.assign({className:ie.a.buttonItem},me),r.a.createElement(x.a,{type:"primary",htmlType:"submit",loading:c.$saveNginx},"\u8fdb\u5165\u5e94\u7528"),r.a.createElement(x.a,{onClick:function(){E.a.confirm({content:"\u786e\u5b9a\u8981\u6e05\u7a7a\u5417\uff1f",onOk:function(){var e={};["nginx","conf","pid","access","error"].forEach((function(t){e[t]=""})),f.setFieldsValue(Object(v.a)({},e,{logs:[]}))}})},className:"e-ml16"},"\u6e05 \u7a7a"),s.data.edit&&r.a.createElement(x.a,{onClick:function(){u.router.back()},className:"e-ml16"},"\u8fd4 \u56de")))))},ge=n(3),xe=n.n(ge),he=n(11),ve={data:{edit:!1},effects:{save:function(e){var t={};Object.keys(e).forEach((function(n){var a=e[n];"logs"!==n?t[n]=V(a):a&&(t[n]=a.map((function(e){return V(e)})).filter((function(e){return e})))})),this.updateState(t),J("nginx",JSON.stringify(t))},$saveNginx:function(e){var t=this;return Object(he.a)(xe.a.mark((function n(){return xe.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.save(e),n.next=3,G();case 3:u.router.replace("/nginx",!0);case 4:case"end":return n.stop()}}),n)})))()},init:function(){var e=J("nginx");this.updateState(e?JSON.parse(e):ce())}},render:function(){return this.data.edit||!J("nginx")?r.a.createElement(de,null):r.a.createElement(u.Redirect,{to:"/nginx"})},onInit:function(){this.store.dispatch({type:"init"})}},be=(n(386),n(195)),Ee=n.n(be),je=(n(182),n(100)),ke=n.n(je),we=n(435),Oe=n(436),ye=n(437),Ce=n(438),Se=n(439),Ne=n(440),$e=(n(391),n(193)),Ie=n.n($e),_e=(n(393),n(139)),Fe=n.n(_e),Pe=n(434),Re=r.a.createElement(Fe.a,null,[{url:"https://github.com/yinjiazeng/NginxGUI/issues",title:"\u5e38\u89c1\u95ee\u9898"},{url:"https://github.com/yinjiazeng/NginxGUI/issues/new",title:"\u5efa\u8bae\u53cd\u9988"},{url:"https://github.com/yinjiazeng/NginxGUI/blob/master/README.md",title:"\u5173\u4e8eNginxGUI"}].map((function(e){var t=e.url,n=e.title;return r.a.createElement(Fe.a.Item,{key:n},r.a.createElement("a",{onClick:function(){return $.shell.openExternal(t)}},n))}))),qe=function(e){return r.a.createElement(Ie.a,{overlay:Re,placement:"bottomRight"},r.a.createElement(Pe.a,e))},Te=function(e,t){Object(a.useEffect)((function(){var n=function(){var n=Object(he.a)(xe.a.mark((function n(){var a;return xe.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=t[0]){n.next=3;break}return n.abrupt("return",null);case 3:if(".log"!==Z.a.extname(a)){n.next=14;break}return n.prev=5,n.next=8,A(a);case 8:n.next=14;break;case 10:return n.prev=10,n.t0=n.catch(5),n.next=14,D(a,"");case 14:return n.prev=14,n.abrupt("return",q.a.watch(a,U(e)));case 18:n.prev=18,n.t1=n.catch(14);case 20:case"end":return n.stop()}}),n,null,[[5,10],[14,18]])})));return function(){return n.apply(this,arguments)}}()();return Object(he.a)(xe.a.mark((function e(){var t;return xe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n;case 2:(t=e.sent)&&t.close();case 4:case"end":return e.stop()}}),e)})))}),t)},Be=n(194),ze=n.n(Be),Le=function(e){var t=e.file,n=Object(a.useState)([]),c=Object(k.a)(n,2),o=c[0],i=c[1],s=Object(a.useState)(!1),u=Object(k.a)(s,2),l=u[0],f=u[1],m=Object(a.useRef)(),p=U(Object(he.a)(xe.a.mark((function e(){return xe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t,"\u65e5\u5fd7\u6587\u4ef6\u4e0d\u5b58\u5728");case 2:return f(!0),e.next=5,D(t,"");case 5:i([]),f(!1);case 7:case"end":return e.stop()}}),e)})))),d=U(Object(he.a)(xe.a.mark((function e(){return xe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t,"\u65e5\u5fd7\u6587\u4ef6\u4e0d\u5b58\u5728");case 2:$.shell.openItem(t);case 3:case"end":return e.stop()}}),e)})))),g=function(){var e=Object(he.a)(xe.a.mark((function e(){var n,a;return xe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(t);case 2:n=e.sent,a=n.split(/\n/g).slice(-100),i(a.filter((function(e){return e.trim()}))),m.current&&(m.current.scrollTop=19920604);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Te((function(){g()}),[t]),Object(a.useEffect)((function(){g()}),[]),r.a.createElement(ke.a,{title:t,extra:r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{size:"small",onClick:d},"\u5168\u90e8\u65e5\u5fd7"),r.a.createElement(x.a,{size:"small",className:"e-ml8",onClick:p,loading:l},"\u6e05\u9664\u65e5\u5fd7")),className:ze.a.log},r.a.createElement("div",{ref:m},o.map((function(e,t){return r.a.createElement("p",{key:t},e)}))))},Ve=n(140),Je=n.n(Ve),Ge=function(){var e=Object(u.useConnect)(),t=Object(k.a)(e,2),n=t[0],c=n.loadings,o=n.started,i=n.nginx,s=n.conf,l=n.error,f=n.access,m=n.logs,p=t[1],d=Object(a.useMemo)((function(){return[f,l].concat(m||[])}),[f,l,m]),g=function(){p({type:"$reload"})},h=U(Object(he.a)(xe.a.mark((function e(){return xe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(s,"conf\u6587\u4ef6\u4e0d\u5b58\u5728");case 2:$.shell.openItem(s);case 3:case"end":return e.stop()}}),e)})))),v=U(Object(he.a)(xe.a.mark((function e(){return xe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(Z.a.dirname(i),"\u76ee\u5f55\u4e0d\u5b58\u5728");case 2:t=i,$.shell.showItemInFolder(L?t.replace(/\//g,"\\"):t);case 3:case"end":return e.stop()}var t}),e)}))));return Te((function(){o&&g()}),[s,o]),r.a.createElement(Ee.a,{spinning:c.$checkStart,wrapperClassName:Je.a.spin},r.a.createElement(ke.a,{className:Je.a.card,bordered:!1,title:r.a.createElement("span",null,o?r.a.createElement(x.a,{onClick:function(){p({type:"$stop"})},danger:!0,loading:c.$stop},!c.$stop&&r.a.createElement(we.a,null),"\u505c\u6b62"):r.a.createElement(x.a,{type:"primary",onClick:function(){p({type:"$start"})},loading:c.$start},!c.$start&&r.a.createElement(Oe.a,null),"\u542f\u52a8"),o&&r.a.createElement(x.a,{className:"e-ml8",onClick:g,type:"primary",ghost:!0,loading:c.$reload},!c.$reload&&r.a.createElement(ye.a,null),"\u91cd\u542f")),extra:r.a.createElement("span",null,r.a.createElement(x.a,{onClick:function(){u.router.location("/",{edit:!0})}},r.a.createElement(Ce.a,null),"\u7f16\u8f91\u8def\u5f84"),r.a.createElement(x.a,{onClick:h,className:"e-ml8"},r.a.createElement(Ce.a,null),"\u7f16\u8f91\u914d\u7f6e"),r.a.createElement(x.a,{onClick:v,className:"e-ml8"},r.a.createElement(Se.a,null),"\u6253\u5f00\u76ee\u5f55"),r.a.createElement(x.a,{onClick:function(){p({type:"$delete"})},className:"e-ml8",type:"danger",loading:c.$delete},!c.$delete&&r.a.createElement(Ne.a,null),"\u5220\u9664"),r.a.createElement(qe,{className:"e-ml8"}))},d.map((function(e,t){return r.a.createElement(Le,{file:e,key:"".concat(e||"","_").concat(t)})}))))},Ue={state:{nginx:"",conf:"",pid:"",access:"",error:"",logs:[],started:!1},effects:{getCode:function(e){var t=this.getState(),n=t.nginx,a=t.conf;return'"'.concat(n,'" -c "').concat(a,'"').concat(e).concat(L?' -p "'.concat(Z.a.dirname(n),'"'):"")},checkExist:function(){var e=this;return Object(he.a)(xe.a.mark((function t(){var n,a,r;return xe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getState(),a=n.nginx,r=n.conf,t.next=3,A(a,"nginx\u6587\u4ef6\u4e0d\u5b58\u5728");case 3:return t.next=5,A(r,"conf\u6587\u4ef6\u4e0d\u5b58\u5728");case 5:case"end":return t.stop()}}),t)})))()},cmd:function(e,t){var n=this;return Object(he.a)(xe.a.mark((function a(){return xe.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.checkExist();case 2:return a.next=4,M(n.getCode(e),t);case 4:case"end":return a.stop()}}),a)})))()},$start:function(){var e=this;return Object(he.a)(xe.a.mark((function t(){return xe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!L){t.next=6;break}return t.next=3,e.checkExist();case 3:M(e.getCode("")),t.next=8;break;case 6:return t.next=8,e.cmd("","\u542f\u52a8\u5931\u8d25");case 8:return t.next=10,G();case 10:e.updateState({started:!0});case 11:case"end":return t.stop()}}),t)})))()},$stop:function(){var e=this;return Object(he.a)(xe.a.mark((function t(){return xe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.cmd(" -s stop","\u505c\u6b62\u5931\u8d25");case 2:return t.next=4,G();case 4:e.updateState({started:!1});case 5:case"end":return t.stop()}}),t)})))()},$reload:function(){var e=this;return Object(he.a)(xe.a.mark((function t(){return xe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,G();case 2:return t.next=4,e.cmd(" -s reload","\u91cd\u542f\u5931\u8d25");case 4:case"end":return t.stop()}}),t)})))()},$delete:function(){var e=this;return Object(he.a)(xe.a.mark((function t(){var n;return xe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.getState(),!n.started){t.next=4;break}return t.next=4,e.$stop();case 4:J("nginx",""),u.router.replace("/");case 6:case"end":return t.stop()}}),t)})))()},$checkStart:function(){var e=this;return Object(he.a)(xe.a.mark((function t(){var n,a,r;return xe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=J("nginx"),a=n?JSON.parse(n):e.state,t.prev=2,t.next=5,G(100);case 5:return t.next=7,K(a.pid);case 7:return r=t.sent,t.next=10,W(r);case 10:e.updateState(Object(v.a)({},a,{started:!0})),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),e.updateState(a);case 16:case"end":return t.stop()}}),t,null,[[2,13]])})))()}},render:function(){return J("nginx")?r.a.createElement(Ge,null):r.a.createElement(u.Redirect,{to:"/"})},onInit:function(){this.store.dispatch({type:"$checkStart"})}},Ae=(n(425),function(){return r.a.createElement(s.a,{locale:l.a},r.a.createElement(u.Router,null,r.a.createElement(u.Route,Object.assign({path:"/"},ve)),r.a.createElement(u.Route,Object.assign({path:"/nginx",cache:!0},Ue))))});u.nuomi.config({effects:{updateState:function(e){this.dispatch({type:"_updateState",payload:e})}}}),_.a.config({duration:2,maxCount:3}),u.router.listener((function(){_.a.destroy()})),window.addEventListener("keydown",(function(e){e.ctrlKey&&116===e.keyCode&&window.location.reload()})),o.a.render(r.a.createElement(Ae,null),document.getElementById("root"))},58:function(e,t){e.exports=require("fs")}},[[198,1,2]]]);
//# sourceMappingURL=main.745c031e.chunk.js.map